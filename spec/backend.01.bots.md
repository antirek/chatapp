# –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –±–æ—Ç–æ–≤ (Backend)

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ –±–æ—Ç–æ–≤ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –¥–∏–∞–ª–æ–≥–∞–º–∏. –ë–æ—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ RabbitMQ –∏ –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ç–≤–µ—Ç—ã –≤ –¥–∏–∞–ª–æ–≥–∏.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **BotService** (`backend/src/services/BotService.js`)
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞–º–∏ –∏ –∏—Ö handlers
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –±–æ—Ç–æ–≤
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –±–æ—Ç–æ–≤

2. **BotWorker** (`backend/src/workers/botWorker.js`)
   - –û—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å (worker)
   - –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ RabbitMQ updates –¥–ª—è –±–æ—Ç–æ–≤
   - –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º handlers

3. **–ú–æ–¥–µ–ª—å Bot** (`backend/src/models/Bot.js`)
   - –•—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–æ—Ç–∞—Ö –≤ MongoDB
   - –ü–æ–ª—è: `botId`, `name`, `type`, `handler`, `description`, `isActive`, `commands`
   - `commands`: –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –ø–æ–ª—è–º–∏ `name`, `description`, `usage`

### RabbitMQ –ü–æ–¥–ø–∏—Å–∫–∞

–ë–æ—Ç—ã –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ RabbitMQ —Å routing key:
```
user.bot.{botId}.*
```

–ù–∞–ø—Ä–∏–º–µ—Ä:
- `user.bot.bot_echo.*` - –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –¥–ª—è bot_echo
- `user.bot.bot_classify.*` - –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –¥–ª—è bot_classify

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ `botWorker`:
1. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ MongoDB
2. –í—ã–∑—ã–≤–∞–µ—Ç `BotService.initializeSystemBots()`
3. –°–æ–∑–¥–∞–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –±–æ—Ç–æ–≤ –≤ MongoDB
4. –°–æ–∑–¥–∞–µ—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç –±–æ—Ç–æ–≤ –≤ Chat3 –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å `type: 'bot'`
5. –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ RabbitMQ updates –¥–ª—è –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –±–æ—Ç–æ–≤

## –°–∏—Å—Ç–µ–º–Ω—ã–µ –±–æ—Ç—ã

### bot_echo

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ë–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç —ç—Ö–æ–º –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è (–ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ).

**BotId:** `bot_echo`

**Handler:** `'echo'`

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
- –°–æ–∑–¥–∞–µ—Ç—Å—è –≤ MongoDB —Å `botId: 'bot_echo'`, `name: 'Echo Bot'`, `type: 'system'`, `handler: 'echo'`
- –°–æ–∑–¥–∞–µ—Ç—Å—è –≤ Chat3 –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å `userId: 'bot_echo'`, `type: 'bot'`, `name: 'Echo'`

**–ö–æ–º–∞–Ω–¥—ã:**
- `/info` - –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ (–∏–º—è, –æ–ø–∏—Å–∞–Ω–∏–µ, ID)

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –ü–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ RabbitMQ (routing key: `user.bot.bot_echo.*`)
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è `message.create`
- –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç:
  - –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (`senderId === 'system'` –∏–ª–∏ `type` –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `system.`)
  - –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –¥—Ä—É–≥–∏—Ö –±–æ—Ç–æ–≤ (`senderId.startsWith('bot_')`)
- –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `/` - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–º–∞–Ω–¥—ã
- –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –∫–æ–º–∞–Ω–¥–∞ - –æ—Ç–≤–µ—á–∞–µ—Ç —Ç–µ–º –∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ–º (—ç—Ö–æ)

**–ü—Ä–∏–º–µ—Ä—ã:**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–ü—Ä–∏–≤–µ—Ç!"
bot_echo: "–ü—Ä–∏–≤–µ—Ç!"

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "/info"
bot_echo: "–ë–æ—Ç: Echo Bot
          –û–ø–∏—Å–∞–Ω–∏–µ: Echo bot that responds with the same message
          ID: bot_echo"
```

**–ú–µ—Ç–∞-–¥–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞:**
```javascript
{
  content: <–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ>,
  type: <—Ç–∏–ø –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è> || 'internal.text',
  meta: {
    botResponse: true,
    originalMessageId: <ID –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è>
  }
}
```

### bot_classify

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ë–æ—Ç –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∏–∞–ª–æ–≥–æ–≤ —Å –±–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏.

**BotId:** `bot_classify`

**Handler:** `'classify'`

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
- –°–æ–∑–¥–∞–µ—Ç—Å—è –≤ MongoDB —Å `botId: 'bot_classify'`, `name: 'Classify Bot'`, `type: 'system'`, `handler: 'classify'`
- –°–æ–∑–¥–∞–µ—Ç—Å—è –≤ Chat3 –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å `userId: 'bot_classify'`, `type: 'bot'`, `name: 'Classify'`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –Ω–æ–≤—ã–µ –¥–∏–∞–ª–æ–≥–∏, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ `/api/channels`

**–ö–æ–º–∞–Ω–¥—ã:**
- `/classify <–ø–∞—Ä–∞–º–µ—Ç—Ä>` - –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∞–ª–æ–≥ –≤—Ä—É—á–Ω—É—é
  - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–µ—Ç–∞-—Ç–µ–≥ `classification` –≤ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
  - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `classifyStatus = 'end'`
  - –î–æ–±–∞–≤–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ "–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫: <–ø–∞—Ä–∞–º–µ—Ç—Ä>"
  - –ü—Ä–∏–º–µ—Ä: `/classify –ø—Ä–æ–±–ª–µ–º–∞` –∏–ª–∏ `/classify –ø–æ–∂–µ–ª–∞–Ω–∏–µ`

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:**

#### –°–æ—Å—Ç–æ—è–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞ (classifyStatus)

–î–∏–∞–ª–æ–≥ –∏–º–µ–µ—Ç –º–µ—Ç–∞-—Ç–µ–≥ `classifyStatus` —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏:
- `'init'` - –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–∏–∞–ª–æ–≥–∞)
- `'firstStep'` - –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∫–æ–Ω—Ç–∞–∫—Ç–∞
- `'end'` - –ø–æ—Å–ª–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

#### –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

**1. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞ (classifyStatus = 'init')**

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–∏–∞–ª–æ–≥–∞ —á–µ—Ä–µ–∑ `/api/channels`:
1. –°–æ–∑–¥–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ —Å `classifyStatus: 'init'` –≤ –º–µ—Ç–∞-—Ç–µ–≥–∞—Ö
2. –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: "–ù–∞—á–∞—Ç –¥–∏–∞–ª–æ–≥"
3. –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫–æ–Ω—Ç–∞–∫—Ç –∫–∞–∫ —É—á–∞—Å—Ç–Ω–∏–∫
4. –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è `bot_classify` –∫–∞–∫ —É—á–∞—Å—Ç–Ω–∏–∫
5. –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: "–ü–æ–¥–∫–ª—é—á–µ–Ω bot_classify"
6. –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∫–æ–Ω—Ç–∞–∫—Ç–∞

**2. –ü–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (classifyStatus = 'init' ‚Üí 'firstStep')**

–ö–æ–≥–¥–∞ `bot_classify` –ø–æ–ª—É—á–∞–µ—Ç –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∫–æ–Ω—Ç–∞–∫—Ç–∞:
- –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `/classify` - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –∫–æ–º–∞–Ω–¥–∞ (—Å–º. –ö–æ–º–∞–Ω–¥—ã)
- –ò–Ω–∞—á–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `classifyStatus === 'init'`
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `classifyStatus = 'firstStep'`
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ: "–û–ø–∏—à–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–µ–µ –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É"
- –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –∫–∞–Ω–∞–ª —á–µ—Ä–µ–∑ `messageSender` worker (–µ—Å–ª–∏ `channelId` –¥–æ—Å—Ç—É–ø–µ–Ω)

**3. –í—Ç–æ—Ä–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (classifyStatus = 'firstStep' ‚Üí 'end')**

–ö–æ–≥–¥–∞ `bot_classify` –ø–æ–ª—É—á–∞–µ—Ç –≤—Ç–æ—Ä–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∫–æ–Ω—Ç–∞–∫—Ç–∞:
- –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `/classify` - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –∫–æ–º–∞–Ω–¥–∞ (—Å–º. –ö–æ–º–∞–Ω–¥—ã)
- –ò–Ω–∞—á–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `classifyStatus === 'firstStep'`
- –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ:
  - –ï—Å–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–æ–≤–æ "–ø—Ä–æ–±–ª–µ–º–∞" ‚Üí –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è: `'–ø—Ä–æ–±–ª–µ–º–∞'`
  - –ò–Ω–∞—á–µ ‚Üí –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è: `'–ø–æ–∂–µ–ª–∞–Ω–∏–µ'`
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `classifyStatus = 'end'`
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–µ—Ç–∞-—Ç–µ–≥ `classification` –≤ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –î–æ–±–∞–≤–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: "–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫: <–≤–∞—Ä–∏–∞–Ω—Ç>"
- –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω" (`usr_mu7cgrut`) –∫–∞–∫ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –¥–∏–∞–ª–æ–≥–∞
- –î–æ–±–∞–≤–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: "–ü–æ–¥–∫–ª—é—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –¥–∏–∞–ª–æ–≥—É"

**4. –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (classifyStatus = 'end')**

–ï—Å–ª–∏ `classifyStatus === 'end'`:
- –ë–æ—Ç –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç)

#### –ü—Ä–æ–ø—É—Å–∫ —Å–æ–æ–±—â–µ–Ω–∏–π

–ë–æ—Ç –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç:
- –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (`senderId === 'system'` –∏–ª–∏ `type` –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `system.`)
- –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –¥—Ä—É–≥–∏—Ö –±–æ—Ç–æ–≤ (`senderId.startsWith('bot_')`)

#### –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ –∫–∞–Ω–∞–ª

–°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç `bot_classify` –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ –∫–∞–Ω–∞–ª —á–µ—Ä–µ–∑ `messageSender` worker:
- `channelId` –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ `meta` —Å–æ–æ–±—â–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- `messageSender` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç `bot_classify` (–Ω–µ —Ç–æ–ª—å–∫–æ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –∫–∞–Ω–∞–ª, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –∫–æ–Ω—Ç–∞–∫—Ç–æ–º

## –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

### –ü—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏

1. **RabbitMQ Update:**
   - –ü—Ä–∏—Ö–æ–¥–∏—Ç update —á–µ—Ä–µ–∑ RabbitMQ —Å routing key `user.bot.{botId}.*`
   - –°–æ–±—ã—Ç–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `message.create`

2. **BotWorker:**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ `userId` –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `bot_`
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –±–æ—Ç –∞–∫—Ç–∏–≤–µ–Ω (`botIds.has(userId)`)
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –æ—Ç –±–æ—Ç–∞ (`senderId` –Ω–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `bot_`)
   - –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
   - –í—ã–∑—ã–≤–∞–µ—Ç `BotService.processMessage(botId, update)`

3. **BotService:**
   - –ü–æ–ª—É—á–∞–µ—Ç –±–æ—Ç–∞ –∏–∑ MongoDB
   - –ù–∞—Ö–æ–¥–∏—Ç handler –ø–æ `bot.handler`
   - –í—ã–∑—ã–≤–∞–µ—Ç handler —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: `(bot, message, dialogId)`
   - –ï—Å–ª–∏ handler –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–≤–µ—Ç, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ —á–µ—Ä–µ–∑ Chat3Client
   - –î–ª—è `bot_classify` –¥–æ–±–∞–≤–ª—è–µ—Ç `channelId` –≤ meta –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π

4. **MessageSender (–¥–ª—è bot_classify):**
   - –ü–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –±–æ—Ç–∞ —á–µ—Ä–µ–∑ RabbitMQ
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —ç—Ç–æ `personal_contact` –¥–∏–∞–ª–æ–≥
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ `channelId` –≤ meta
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ –∫–∞–Ω–∞–ª (WhatsApp, Telegram –∏ —Ç.–¥.)

## –ú–µ—Ç–∞-—Ç–µ–≥–∏ –¥–∏–∞–ª–æ–≥–∞

### classifyStatus

**–¢–∏–ø:** `string`

**–ó–Ω–∞—á–µ–Ω–∏—è:**
- `'init'` - –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –æ–∂–∏–¥–∞–µ—Ç—Å—è –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- `'firstStep'` - –ø–æ–ª—É—á–µ–Ω–æ –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –æ–∂–∏–¥–∞–µ—Ç—Å—è –≤—Ç–æ—Ä–æ–µ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `'end'` - –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–∏–∞–ª–æ–≥–∞: `classifyStatus: { value: 'init' }`
- –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è: `classifyStatus: { value: 'firstStep' }`
- –ü–æ—Å–ª–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: `classifyStatus: { value: 'end' }`

### classification

**–¢–∏–ø:** `string`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –†–µ–∑—É–ª—å—Ç–∞—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–∏–∞–ª–æ–≥–∞

**–ó–Ω–∞—á–µ–Ω–∏—è:**
- `'–ø—Ä–æ–±–ª–µ–º–∞'` - –¥–∏–∞–ª–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ –ø—Ä–æ–±–ª–µ–º–∞
- `'–ø–æ–∂–µ–ª–∞–Ω–∏–µ'` - –¥–∏–∞–ª–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ –ø–æ–∂–µ–ª–∞–Ω–∏–µ
- –õ—é–±–æ–µ –¥—Ä—É–≥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–ø—Ä–∏ —Ä—É—á–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É)

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤—Ç–æ—Ä–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- –í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É `/classify <–ø–∞—Ä–∞–º–µ—Ç—Ä>`

## –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

### –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–∏–∞–ª–æ–≥–∞

1. **"–ù–∞—á–∞—Ç –¥–∏–∞–ª–æ–≥"**
   - –¢–∏–ø: `system.notification`
   - –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å: `'system'`
   - –í—Ä–µ–º—è: —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞

2. **"–ü–æ–¥–∫–ª—é—á–µ–Ω bot_classify"**
   - –¢–∏–ø: `system.notification`
   - –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å: `'system'`
   - –í—Ä–µ–º—è: –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è `bot_classify` –∫–∞–∫ —É—á–∞—Å—Ç–Ω–∏–∫–∞

### –ü—Ä–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

1. **"–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫: <–≤–∞—Ä–∏–∞–Ω—Ç>"**
   - –¢–∏–ø: `system.notification`
   - –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å: `'system'`
   - –ú–µ—Ç–∞: `{ classification: '–ø—Ä–æ–±–ª–µ–º–∞' | '–ø–æ–∂–µ–ª–∞–Ω–∏–µ', classifiedBy: 'bot_classify' }`
   - –í—Ä–µ–º—è: –ø–æ—Å–ª–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤—Ç–æ—Ä–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è

2. **"–ü–æ–¥–∫–ª—é—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –¥–∏–∞–ª–æ–≥—É"**
   - –¢–∏–ø: `system.notification`
   - –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å: `'system'`
   - –í—Ä–µ–º—è: –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω"

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Channels API

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ bot_classify

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–∏–∞–ª–æ–≥–∞ —á–µ—Ä–µ–∑ `POST /api/channels/:channelType/:instanceId/message`:
- –ï—Å–ª–∏ –¥–∏–∞–ª–æ–≥ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π (–Ω–µ –Ω–∞–π–¥–µ–Ω —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è `bot_classify` –∫–∞–∫ —É—á–∞—Å—Ç–Ω–∏–∫
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è `classifyStatus: 'init'`

### –ü–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–∏–∞–ª–æ–≥–∞

1. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞ —Å –º–µ—Ç–∞-—Ç–µ–≥–∞–º–∏
2. –°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ "–ù–∞—á–∞—Ç –¥–∏–∞–ª–æ–≥"
3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞ –∫–∞–∫ —É—á–∞—Å—Ç–Ω–∏–∫–∞
4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ `bot_classify` –∫–∞–∫ —É—á–∞—Å—Ç–Ω–∏–∫–∞
5. –°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ "–ü–æ–¥–∫–ª—é—á–µ–Ω bot_classify"
6. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∫–æ–Ω—Ç–∞–∫—Ç–∞
7. –ë–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç "–û–ø–∏—à–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–µ–µ –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É"

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–æ–≤

### –§–æ—Ä–º–∞—Ç –∫–æ–º–∞–Ω–¥

–ö–æ–º–∞–Ω–¥—ã –∏–º–µ—é—Ç —Ñ–æ—Ä–º–∞—Ç: `/–∫–æ–º–∞–Ω–¥–∞@bot_XXX` –∏–ª–∏ `/–∫–æ–º–∞–Ω–¥–∞` (–µ—Å–ª–∏ –±–æ—Ç –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤ –¥–∏–∞–ª–æ–≥–µ)

–ù–∞–ø—Ä–∏–º–µ—Ä:
- `/info@bot_echo` - –∫–æ–º–∞–Ω–¥–∞ info –¥–ª—è bot_echo
- `/classify –ø—Ä–æ–±–ª–µ–º–∞@bot_classify` - –∫–æ–º–∞–Ω–¥–∞ classify –¥–ª—è bot_classify

### bot_echo –∫–æ–º–∞–Ω–¥—ã

#### `/info`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** `/info` –∏–ª–∏ `/info@bot_echo`

**–û—Ç–≤–µ—Ç:**
```
–ë–æ—Ç: Echo Bot
–û–ø–∏—Å–∞–Ω–∏–µ: Echo bot that responds with the same message
ID: bot_echo
```

### bot_classify –∫–æ–º–∞–Ω–¥—ã

#### `/classify <–ø–∞—Ä–∞–º–µ—Ç—Ä>`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∞–ª–æ–≥ –≤—Ä—É—á–Ω—É—é

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** `/classify <–ø–∞—Ä–∞–º–µ—Ç—Ä>` –∏–ª–∏ `/classify <–ø–∞—Ä–∞–º–µ—Ç—Ä>@bot_classify`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `<–ø–∞—Ä–∞–º–µ—Ç—Ä>` - –ª—é–±–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–ø—Ä–æ–±–ª–µ–º–∞", "–ø–æ–∂–µ–ª–∞–Ω–∏–µ", "–≤–æ–ø—Ä–æ—Å" –∏ —Ç.–¥.)

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–µ—Ç–∞-—Ç–µ–≥ `classification` –≤ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `classifyStatus = 'end'`
3. –î–æ–±–∞–≤–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: "–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫: <–ø–∞—Ä–∞–º–µ—Ç—Ä>"
4. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: "–î–∏–∞–ª–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –∫–∞–∫: <–ø–∞—Ä–∞–º–µ—Ç—Ä>"

**–ü—Ä–∏–º–µ—Ä—ã:**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /classify –ø—Ä–æ–±–ª–µ–º–∞
bot_classify: –î–∏–∞–ª–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –∫–∞–∫: –ø—Ä–æ–±–ª–µ–º–∞
[–°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ]: –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫: –ø—Ä–æ–±–ª–µ–º–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /classify –≤–æ–ø—Ä–æ—Å
bot_classify: –î–∏–∞–ª–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –∫–∞–∫: –≤–æ–ø—Ä–æ—Å
[–°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ]: –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫: –≤–æ–ø—Ä–æ—Å
```

**–û—à–∏–±–∫–∏:**
- –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ —É–∫–∞–∑–∞–Ω: "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /classify <–ø–∞—Ä–∞–º–µ—Ç—Ä>\n–ü—Ä–∏–º–µ—Ä: /classify –ø—Ä–æ–±–ª–µ–º–∞"

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### bot_echo

**–°—Ü–µ–Ω–∞—Ä–∏–π 1:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—ã—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?"
2. bot_echo –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ RabbitMQ
3. bot_echo –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç: "–ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?"
```

**–°—Ü–µ–Ω–∞—Ä–∏–π 2:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–º–∞–Ω–¥—É

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "/info"
2. bot_echo –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ RabbitMQ
3. bot_echo –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ
```

### bot_classify

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ù–æ–≤—ã–π –¥–∏–∞–ª–æ–≥ —Å –∫–æ–Ω—Ç–∞–∫—Ç–æ–º

```
1. POST /api/channels/whatsapp/W0002/message
   Body: { phone: "79123456701", text: "Hello", name: "–ò–≤–∞–Ω" }
   
2. –°–æ–∑–¥–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ dlg_xxx
   - classifyStatus: 'init'
   - –°–∏—Å—Ç–µ–º–Ω–æ–µ: "–ù–∞—á–∞—Ç –¥–∏–∞–ª–æ–≥"
   - –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫–æ–Ω—Ç–∞–∫—Ç
   - –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è bot_classify
   - –°–∏—Å—Ç–µ–º–Ω–æ–µ: "–ü–æ–¥–∫–ª—é—á–µ–Ω bot_classify"
   - –°–æ–æ–±—â–µ–Ω–∏–µ: "Hello" (–æ—Ç –∫–æ–Ω—Ç–∞–∫—Ç–∞)

3. bot_classify –ø–æ–ª—É—á–∞–µ—Ç "Hello"
   - classifyStatus: 'init' ‚Üí 'firstStep'
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç: "–û–ø–∏—à–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–µ–µ –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É"
   - –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ WhatsApp –∫–∞–Ω–∞–ª

4. –ö–æ–Ω—Ç–∞–∫—Ç –æ—Ç–≤–µ—á–∞–µ—Ç: "–£ –Ω–∞—Å –ø—Ä–æ–±–ª–µ–º–∞ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π"

5. bot_classify –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
   - classifyStatus: 'firstStep' ‚Üí 'end'
   - –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è: "–ø—Ä–æ–±–ª–µ–º–∞" (—Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–æ–≤–æ "–ø—Ä–æ–±–ª–µ–º–∞")
   - –ú–µ—Ç–∞-—Ç–µ–≥ classification: "–ø—Ä–æ–±–ª–µ–º–∞"
   - –°–∏—Å—Ç–µ–º–Ω–æ–µ: "–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫: –ø—Ä–æ–±–ª–µ–º–∞"
   - –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω"
   - –°–∏—Å—Ç–µ–º–Ω–æ–µ: "–ü–æ–¥–∫–ª—é—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –¥–∏–∞–ª–æ–≥—É"

**–°—Ü–µ–Ω–∞—Ä–∏–π 2:** –†—É—á–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "/classify –≤–æ–ø—Ä–æ—Å"
2. bot_classify –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É
3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç classification: "–≤–æ–ø—Ä–æ—Å"
4. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç classifyStatus: 'end'
5. –°–∏—Å—Ç–µ–º–Ω–æ–µ: "–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫: –≤–æ–ø—Ä–æ—Å"
6. bot_classify: "–î–∏–∞–ª–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –∫–∞–∫: –≤–æ–ø—Ä–æ—Å"
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –ï—Å–ª–∏ –±–æ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω ‚Üí —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
- –ï—Å–ª–∏ handler –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –æ—à–∏–±–∫–∞ –≤ –ª–æ–≥, —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
- –ï—Å–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å ‚Üí –æ—à–∏–±–∫–∞ –≤ –ª–æ–≥, –Ω–æ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç –ø–æ—Ç–æ–∫

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∫—ç—à–∏—Ä—É—é—Ç—Å—è (Set) –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- –ö—ç—à –æ—á–∏—â–∞–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ (–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ 1000 —Å–æ–æ–±—â–µ–Ω–∏–π)

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –±–æ—Ç–æ–≤ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏:
- `ü§ñ [START]` / `‚úÖ [END]` - –Ω–∞—á–∞–ª–æ/–∫–æ–Ω–µ—Ü –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `üìä [Classify Bot]` - –¥–µ–π—Å—Ç–≤–∏—è bot_classify
- `‚è≠Ô∏è` - –ø—Ä–æ–ø—É—Å–∫ —Å–æ–æ–±—â–µ–Ω–∏—è
- `‚ùå` - –æ—à–∏–±–∫–∏

## –°—Ç–∞—Ç—É—Å

**–°—Ç–∞—Ç—É—Å:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

**–î–∞—Ç–∞:** 2025-01-XX

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** 
- `bot_echo` –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- `bot_classify` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, —Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

